<!-- Progress bar -->
<div class="block score">
  <div class="score-title">
    Ваш прогресс
  </div>
  <div id="experience">
    {club_experience}
  </div>
  <svg id="progressbar" width="175" height="175" viewbox="0 0 175 175" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd"
      d="M65.0834 33.1666C60.0207 33.1666 55.9167 37.2707 55.9167 42.3333L46.75 42.3333C41.6874 42.3333 37.5834 46.4373 37.5834 51.5V60.6666C37.5834 70.7918 45.7915 79 55.9167 79H57.2453C60.7672 90.8336 70.9328 99.806 83.4167 101.592V115.667H69.6667C67.1354 115.667 65.0834 117.719 65.0834 120.25C65.0834 122.781 67.1354 124.833 69.6667 124.833H106.333C108.865 124.833 110.917 122.781 110.917 120.25C110.917 117.719 108.865 115.667 106.333 115.667H92.5834V101.592C105.067 99.806 115.233 90.8336 118.755 79H120.083C130.209 79 138.417 70.7918 138.417 60.6666V51.5C138.417 46.4373 134.313 42.3333 129.25 42.3333H120.083C120.083 37.2707 115.979 33.1666 110.917 33.1666H65.0834ZM120.083 51.5V69.8333C125.146 69.8333 129.25 65.7292 129.25 60.6666V51.5H120.083ZM55.9167 51.5H46.75V60.6666C46.75 65.7292 50.8541 69.8333 55.9167 69.8333V51.5Z"
      fill="#2C3238"></path>
    <circle cx="87.5" cy="87.5" r="82.6633" stroke="#2C3238" stroke-width="9.67337"></circle>
    <circle cx="87.5" cy="87.5" r="82.6633" stroke="#FFF43C" stroke-width="9.67337" id="progress" stroke-dasharray="518.5496826171875, 518.5496826171875" stroke-dashoffset="518.5496826171875"></circle>
    <mask id="path-3-inside-1_0_528" fill="white">
      <path
        d="M87.5 0C106.762 2.29694e-07 125.485 6.35578 140.767 18.0816C156.048 29.8074 167.033 46.2479 172.019 64.8534L162.88 67.3019C158.434 50.7081 148.637 36.0451 135.007 25.5871C121.378 15.1291 104.679 9.4605 87.5 9.4605V0Z">
      </path>
    </mask>
    <text id="level" x="87" y="72" text-anchor="middle" dy="7" fill="#FEFE4C" font-size="48"
      font-family="Bebas Neue">1</text>
    <path
      d="M68.203 141.796L70.327 132.4H68.257L67.357 136.72L66.889 139.654L66.277 136.702L65.197 132.4H63.235L65.971 142.12L65.953 142.228C65.791 143.146 65.215 143.326 64.207 143.254V145.018C66.961 145.198 67.735 144.064 68.203 141.796ZM74.0746 132.4H71.1586V145H73.1386V140.266H74.0746C76.0546 140.266 77.0266 139.168 77.0266 137.152V135.514C77.0266 133.498 76.0546 132.4 74.0746 132.4ZM73.1386 134.2H74.0746C74.7046 134.2 75.0466 134.488 75.0466 135.388V137.278C75.0466 138.178 74.7046 138.466 74.0746 138.466H73.1386V134.2ZM77.7818 135.424V141.976C77.7818 143.992 78.8438 145.144 80.7878 145.144C82.7318 145.144 83.7938 143.992 83.7938 141.976V135.424C83.7938 133.408 82.7318 132.256 80.7878 132.256C78.8438 132.256 77.7818 133.408 77.7818 135.424ZM79.7618 142.102V135.298C79.7618 134.398 80.1578 134.056 80.7878 134.056C81.4178 134.056 81.8138 134.398 81.8138 135.298V142.102C81.8138 143.002 81.4178 143.344 80.7878 143.344C80.1578 143.344 79.7618 143.002 79.7618 142.102ZM88.0685 132.4H85.0805V145H88.1945C90.1745 145 91.2005 143.956 91.2005 142.012V140.986C91.2005 139.654 90.7865 138.7 89.7245 138.286C90.6065 137.872 91.0025 137.044 91.0025 135.748V135.298C91.0025 133.354 90.1205 132.4 88.0685 132.4ZM87.0605 134.2H88.0145C88.7165 134.2 89.0225 134.596 89.0225 135.496V136.198C89.0225 137.206 88.5725 137.53 87.8345 137.53H87.0605V134.2ZM87.0605 139.33H87.9425C88.8425 139.33 89.2205 139.69 89.2205 140.86V141.958C89.2205 142.894 88.8605 143.2 88.1945 143.2H87.0605V139.33ZM94.373 137.71V134.2H97.793V132.4H92.393V145H97.793V143.2H94.373V139.51H97.091V137.71H94.373ZM101 145V139.6H103.25V145H105.266V132.4H103.25V137.8H101V132.4H99.02V145H101ZM106.702 145H109.618C111.598 145 112.57 143.902 112.57 141.886V140.248C112.57 138.232 111.598 137.134 109.618 137.134H108.682V132.4H106.702V145ZM109.618 143.2H108.682V138.934H109.618C110.248 138.934 110.59 139.222 110.59 140.122V142.012C110.59 142.912 110.248 143.2 109.618 143.2Z"
      fill="white" />
  </svg>
  <div class="score-club">
    <svg width="24" height="30" viewBox="0 0 24 30" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M12 30C18.3789 30 24 25.5 24 19.5C24 13.5 19.5 10.5 18 9C15.5989 6.59887 15.0724 3.33912 14.9838 1.47357C14.9502 0.766953 14.2748 0.259722 13.6588 0.607569C11.9486 1.5733 9.03038 3.89879 7.50002 9C6.53622 12.2126 7.50002 15 7.50002 15C7.50002 15 6.00002 14.25 5.25002 12C4.89102 10.923 4.36018 9.50233 3.90427 8.31375C3.5817 7.47282 2.43422 7.47722 2.13958 8.32833C1.25313 10.8889 1.90735e-05 15.0333 1.90735e-05 18C1.90735e-05 25.5 5.62119 30 12 30Z"
        fill="#FEFE4C" />
    </svg>
    <span>{club_score} БАЛЛОВ</span>
  </div>
</div>


<style>
  #progress {
    transform: rotate(-90deg);
    transform-origin: center center;
    stroke-dasharray: 518.5496826171875 518.5496826171875;
    stroke-dashoffset: 518.5496826171875;
    transition: stroke-dashoffset 1s ease-in-out;
  }

</style>

<script>
  setTimeout(() => {
    const clubExperience = +$('#experience').text() || 0;
    const progressLine = document.querySelector('#progress');
    const progressLineLength = progressLine.getTotalLength()
    const progressBar = $(progressLine);
    const progressLevel = $('#level');


    let levelsScore = [0, 149, 399, 849, 1299, 1799, 2299, 2899, 2499, 4199, 5199, 6699, 1000000000000000000000000000000];

    // Высчитываем уровень
    levelsScore.push(clubExperience);

    levelsScore = levelsScore.sort((a, b) => a - b);
    
    const clubLevel = levelsScore.indexOf(clubExperience);

    progressLevel.text(clubLevel);

    console.log(clubLevel);

    // Высчитываем процент до следующего уровня
    const prevLevelScore = levelsScore[clubLevel - 1];
    const nextLevelScore = levelsScore[clubLevel + 1];
    


    const percentageComplete = (clubExperience - prevLevelScore) / (nextLevelScore - prevLevelScore);
    const strokeDashOffsetValue = progressLineLength - (percentageComplete * progressLineLength);

    console.log(percentageComplete);


    setTimeout(() => {
      progressBar.css("stroke-dashoffset", strokeDashOffsetValue);
    }, 500);
    
  }, 0);
</script>
